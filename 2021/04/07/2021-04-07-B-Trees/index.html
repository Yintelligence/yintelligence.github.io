<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="B-Trees, Chaoqun Yin">
    <meta name="description" content="Veni, Vidi, Vici">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>B-Trees | Chaoqun Yin</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.3.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Chaoqun Yin</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Chaoqun Yin</div>
        <div class="logo-desc">
            
            Veni, Vidi, Vici
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">B-Trees</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Data-Structures/">
                                <span class="chip bg-color">Data Structures</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Data-model/" class="post-category">
                                Data model
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-04-07
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2021-04-07
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    2.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    15 Min
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="b-trees">B-Trees</h1>
<p><a href="https://yintelligence.tech/2021/02/22/2021-02-22-Introduction-to-data-structure/">CS61B: Data structure</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=0SCtnf84QrI&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=4">Video</a> + <a target="_blank" rel="noopener" href="https://docs.google.com/presentation/d/1NgaMi7IWs94sC_fhF7_UWx2O4LyPicvVJ9xkru9m2dU/edit#slide=id.g409413421_0637">Slides</a></p>
<p>Textbook <a target="_blank" rel="noopener" href="https://joshhug.gitbooks.io/hug61b/content/chap11/chap111.html">1</a>, <a target="_blank" rel="noopener" href="https://joshhug.gitbooks.io/hug61b/content/chap11/chap112.html">2</a>, <a target="_blank" rel="noopener" href="https://joshhug.gitbooks.io/hug61b/content/chap11/chap113.html">3</a></p>
<h2 id="binary-tree-height"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=0SCtnf84QrI&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=4">Binary Tree Height</a></h2>
<p>Trees range from best-case “bushy” to worst-case “spindly”. The difference in runtime between a worst-case tree and best-case tree is very dramatic.</p>
<p><img src="/images/CS61B/9165224.png" /></p>
<ul>
<li><p><strong>Worst case (“spindly”):</strong> Θ(<em>N</em>)</p></li>
<li><p><strong>Best-case (“bushy”):</strong> Θ(log<em>N</em>)</p>
<blockquote>
<p>where N is number of nodes in the tree</p>
</blockquote></li>
</ul>
<p>The runtimes are dependent on the structure of the tree. If the tree is really spindly, then its basically a linked list and the runtime is linear. If the tree is bushy, then the height of the tree is log<em>N</em> and therefore the runtime grows in log<em>N</em> time.</p>
<h3 id="bigo-and-worst-case">BigO and worst case</h3>
<p>BigO is <strong>not</strong> equivalent to worst case! Remember, BigO is an <strong>upper bound</strong>. As long as a function falls within that bound, it is considered to be inside the BigO of that function. Worst-case is <strong>more</strong> restrictive than BigO.</p>
<blockquote>
<p>As an example, think about searching for hotels. If you are searching for a hotel with worst-case $500 rooms, then only a few hotels would fit that requirement, perhaps only the Ritz Carlton. On the other hand, if you were searching for hotels that are in O(500) or less than $500 rooms, then many hotels would fall under that category from the Motel 6 to the Rodeway Inn to the Ritz Carlton.</p>
</blockquote>
<p>Thus, even though we said the worst-case runtime of a BST is Θ(<em>N</em>), it also falls under O<em>(</em>N<sup>2</sup>). Many people use BigO as shorthand for worst-case, but this is technically <strong>not</strong> synonymous.</p>
<p>Big O is still a useful idea:</p>
<ul>
<li>Allows us to make simple blanket statements, e.g. can just say “binary search is O(log N)” instead of “binary search is Θ(log N) in the worst case”.</li>
<li>Sometimes don’t know the exact runtime, so use O to give an upper bound.
<ul>
<li>Example: Runtime for finding shortest route that goes to all world cities is O(2<sup>N</sup>)<sup>*</sup>. There might be a faster way, but nobody knows one yet.</li>
</ul></li>
<li>Easier to write proofs for Big O than Big Theta, e.g. finding runtime of mergesort, you can round up the number of items to the next power of 2 (see A level study guide problems for Asymptotics2 lecture).</li>
</ul>
<h2 id="height-depth-and-performance"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=yz850zzjrHQ&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=2">Height, Depth, and Performance</a></h2>
<h3 id="height-and-depth">Height and Depth</h3>
<p>Height and average depth are important properties of BSTs.</p>
<ul>
<li>The <strong>“depth” of a node</strong> is how far it is from the root, e.g. depth(g) = 2.</li>
<li>The <strong>“height” of a tree</strong> is the depth of its deepest leaf, e.g. height(s) = 4.</li>
<li>The <strong>“average depth”</strong> of a tree is the average depth of a tree’s nodes.
<ul>
<li>(<strong>0</strong>×1 + <strong>1</strong>×2 + <strong>2</strong>×4 + <strong>3</strong>×6 + <strong>4</strong>×1)/(1+2+4+6+1) = 2.35</li>
</ul></li>
</ul>
<p><img src="/images/CS61B/9165225.png" /></p>
<h3 id="runtime">Runtime</h3>
<p>Height and average depth determine runtimes for BST operations.</p>
<ul>
<li>The <strong>“height” of a tree</strong> determines the worst case runtime to find a node.
<ul>
<li>Example: Worst case is contains(s), requires 5 comparisons (height + 1).</li>
</ul></li>
<li>The <strong>“average depth”</strong> determines the average case runtime to find a node.
<ul>
<li>Example: Average case is 3.35 comparisons (average depth <strong>+ 1</strong>).</li>
</ul></li>
</ul>
<p>The order you insert nodes into a BST determines its height.</p>
<p><strong>Question</strong>: Given integers 1-7, what order of inserting would result in the worst-case height? What order would result in the best case?</p>
<p><strong>Answer</strong> To get the worst-case height you can just insert in order from 1-7. To get the best case height insert 4 first, then 2 and 6, then 1, 3, 5, 7. Convince yourself of this by actually going through the insertion process.</p>
<ul>
<li>A spindly tree.
<ul>
<li>add(1), add(2), add(3), add(4), add(5), add(6), add(7)</li>
</ul></li>
<li>A bushy tree.
<ul>
<li>add(4), add(2), add(1), add(3), add(6), add(5), add(7)</li>
</ul></li>
</ul>
<p><img src="/images/CS61B/9165226.png" /></p>
<p>Yes, having a specific insertion order can help us get a balanced tree. However, we don't even need to be that intentional. If we just insert the nodes in <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=5dGkblzqdmc&amp;t=14s"><strong>random</strong></a> order, it will actually end up being relatively bushy!</p>
<h3 id="randomized-trees-mathematical-analysis">Randomized Trees: Mathematical Analysis</h3>
<p><strong>Average Depth.</strong> If N distinct keys are inserted into a BST, the expected average depth is ~ 2 ln N = Θ(log N).</p>
<ul>
<li><p>Thus, average runtime for contains operation is Θ(log N) on a tree built with random inserts.</p>
<blockquote>
<p>Will discuss this proof briefly closer to the end of this course.</p>
</blockquote></li>
</ul>
<p><strong>Tree Height.</strong> If N distinct keys are inserted in random order, expected tree height is ~ 4.311 ln N <a target="_blank" rel="noopener" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.152.1289&amp;rep=rep1&amp;type=pdf">(see Reed, 2003)</a>.</p>
<ul>
<li><p>Thus, worst case runtime for contains operation is Θ(log N) on a tree built with random inserts.</p>
<blockquote>
<p>Proof is well beyond the scope of the course (and is 27 pages long!).</p>
</blockquote></li>
</ul>
<p>You don't have to know the proof of this, but when we insert randomly into a BST the <strong>average depth</strong> and <strong>height</strong> are expected to be Θ(log<em>N</em>).</p>
<blockquote>
<p>However, we won't always be able to insert into a BST in random order. What if our data comes in <strong>real-time</strong>?</p>
<ul>
<li>Example: Storing dates of events.</li>
</ul>
<p>Then, we will be forced to insert in the order that data comes to us. We will learn about a tree that always maintains its balance later!</p>
</blockquote>
<p>Overall BSTs have:</p>
<ul>
<li>Worst case Θ(N) height.</li>
<li>Best case Θ(log N) height.</li>
<li>Θ(log N) height if constructed via random inserts.</li>
</ul>
<h2 id="b-trees-2-3-trees-2-3-4-trees"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=-ECGVvUHA5c&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=3">B-trees / 2-3 trees / 2-3-4 trees</a></h2>
<p>The problem is adding new leaves at the bottom. This is what causes the height to increase. Take this nice balanced tree below:</p>
<p><img src="/images/CS61B/9165220.png" /></p>
<p><strong>Crazy Idea</strong>: let's just never add a leaf node! When we insert, let's just add to a current leaf node. This way, the height will never increase.</p>
<p>Avoid new leaves by “overstuffing” the leaf nodes.</p>
<ul>
<li>“Overstuffed tree” always has balanced height, because leaf depths never change.</li>
<li>Height is just max(depth).</li>
</ul>
<p><img src="/images/CS61B/9165221.png" /></p>
<h3 id="overstuff">Overstuff</h3>
<p>Overstuffed trees are a logically consistent but very weird data structure.</p>
<p><img src="/images/CS61B/9165222.png" /></p>
<ul>
<li>contains(18):
<ul>
<li>Is 18 &gt; 13? Yes, go right.</li>
<li>Is 18 &gt; 15? Yes, go right.</li>
<li>Is 16 = 18? No.</li>
<li>Is 17 = 18? No.</li>
<li>Is 18 = 18? Yes! Found it.</li>
</ul></li>
</ul>
<h3 id="leaf-nodes-can-get-too-juicy">Leaf nodes can get too juicy</h3>
<p>What is the problem with this idea?</p>
<ul>
<li><p>Leaf nodes can get too juicy.</p>
<blockquote>
<p>If we search for 19, then we will traverse down to the node that contains it, and we still have to look through that node as if we are looking through an array in order to get to the 19 element. This will lead to a runtime of NN again!</p>
</blockquote></li>
</ul>
<p><strong>Solution</strong>:</p>
<ul>
<li>Set a limit L on the number of items, say L=3.</li>
<li>If any node has more than L items, give an item to parent.
<ul>
<li>Which one? Let’s say (arbitrarily) the left-middle.</li>
</ul></li>
</ul>
<p><img src="/images/CS61B/9165223.png" /></p>
<p><strong>New Problem</strong>: 16 is to the right of 17.</p>
<p>Solution:</p>
<ul>
<li>Set a limit L on the number of items, say L=3.</li>
<li>If any node has more than L items, give an item to parent.
<ul>
<li>Pulling item out of full node splits it into left and right.</li>
<li>Parent node now has three children!</li>
</ul></li>
</ul>
<p><img src="/images/CS61B/9165227.png" /></p>
<p>This is a logically consistent and not so weird data structure.</p>
<ul>
<li>contains(18):
<ul>
<li>18 &gt; 13, so go right</li>
<li>18 &gt; 15, so compare vs. 17</li>
<li>18 &gt; 17, so go right</li>
</ul></li>
</ul>
<p>Examining a node costs us O(L) compares, but that’s OK since L is constant.</p>
<h3 id="splitting-non-leaf-nodes"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=xEOdJd7GcmQ&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=4">Splitting non leaf nodes</a></h3>
<p>Suppose we add 20, 21</p>
<p><img src="/images/CS61B/9165228.png" /></p>
<p><img src="/images/CS61B/9165229.png" /></p>
<p>Suppose we add 25, 26</p>
<p><img src="/images/CS61B/91652290.png" /></p>
<h3 id="what-happens-if-the-root-is-too-full">What Happens If The Root Is Too Full?</h3>
<p><img src="/images/CS61B/91652291.png" /></p>
<p>Draw the tree after the root is split.</p>
<p><img src="/images/CS61B/91652292.png" /></p>
<p>Splitting-trees have <strong>perfect balance</strong>.</p>
<ul>
<li>If we split the root, every node gets pushed down by exactly one level.</li>
<li>If we split a leaf node or internal node, the height doesn’t change.</li>
</ul>
<p>The Real Name for Splitting Trees is <strong>“B Trees”</strong>.</p>
<ul>
<li><p>B-trees of order L=3 are also called a 2-3-4 tree or a 2-4 tree.</p>
<ul>
<li><p>“2-3-4” refers to the number of children that a node can have</p>
<blockquote>
<p>e.g. a 2-3-4 tree node may have 2, 3, or 4 children.</p>
</blockquote></li>
</ul></li>
<li><p>B-trees of order L=2 are also called a 2-3 tree.</p></li>
</ul>
<blockquote>
<p><em>The origin of "B-tree" has never been explained by the authors. As we shall see, "balanced," "broad," or "bushy" might apply. Others suggest that the "B" stands for Boeing. Because of his contributions, however, it seems appropriate to think of B-trees as "Bayer"-trees.</em></p>
</blockquote>
<h3 id="a-note-on-terminology">A note on Terminology</h3>
<p>B-Trees are most popular in two specific contexts:</p>
<ul>
<li>Small L (L=2 or L=3):
<ul>
<li>Used as a conceptually simple balanced search tree (as today).</li>
</ul></li>
<li>L is very large (say thousands).
<ul>
<li>Used in practice for databases and filesystems (i.e. systems with very large records).</li>
</ul></li>
</ul>
<p><img src="/images/CS61B/91652293.png" /></p>
<h3 id="insertion-process">Insertion Process</h3>
<p>The process of adding a node to a 2-3-4 tree is:</p>
<ol type="1">
<li>We still always inserting into a leaf node, so take the node you want to insert and traverse down the tree with it, going left and right according to whether or not the node to be inserted is greater than or smaller than the items in each node.</li>
<li>After adding the node to the leaf node, if the new node has 4 nodes, then pop up the middle left node and re-arrange the children accordingly.</li>
<li>If this results in the parent node having 4 nodes, then pop up the middle left node again, rearranging the children accordingly.</li>
<li>Repeat this process until the parent node can accommodate or you get to the root.</li>
</ol>
<p>For a 2-3 tree, go through the same process except push up the middle node in a 3-element node.</p>
<h2 id="b-tree-invariants"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=DeHNhOd4xA0&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=5">B-Tree invariants</a></h2>
<h3 id="exercise-1">Exercise 1</h3>
<p>Add the numbers 1, 2, 3, 4, 5, 6, then 7 (in that order) into a regular BST.</p>
<p><img src="/images/CS61B/91652294.png" /></p>
<p>Then try adding 1, 2, 3, 4, 5, 6, then 7 (in that order) into a 2-3 tree.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://tinyurl.com/balanceYD">Interactive demo</a></li>
<li>In this demo “max-degree” means the maximum number of children, i.e. 3.</li>
</ul>
<p><img src="/images/CS61B/91652295.png" /></p>
<h3 id="exercise-2">Exercise 2</h3>
<p>Find an order such that if you add the items 1, 2, 3, 4, 5, 6, and 7 in that order, the resulting 2-3 tree has height 1.</p>
<ul>
<li>One possible answer: 2, 3, 4, 5, 6, 1, 7</li>
</ul>
<p><img src="/images/CS61B/91652296.png" /></p>
<h3 id="b-tree-invariants-1">B-Tree invariants</h3>
<p>No matter the insertion order you choose, resulting B-Tree is always bushy!</p>
<ul>
<li>May vary in height a little bit, but overall guaranteed to be bushy.</li>
</ul>
<p>Because of the way B-Trees are constructed, we get two nice invariants:</p>
<ol type="1">
<li>All leaves must be the same distance from the source.</li>
<li>A non-leaf node with <strong>k</strong> items must have exactly <strong>k+1</strong> children.</li>
</ol>
<p>These invariants guarantee that our trees will be <strong>bushy</strong>.</p>
<h2 id="b-tree-runtime-analysis"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Cg7k5wKGk_Q&amp;list=PL8FaHk7qbOD41EHkD7CgQuRw1jpH_Fv7-&amp;index=6">B-Tree Runtime Analysis</a></h2>
<h3 id="height-of-a-b-tree-with-limit-l">Height of a B-Tree with Limit L</h3>
<p>L: Max number of items per node.</p>
<p>Height: Between ~log<sub>L+1</sub>(N) and ~log<sub>2</sub>(N)</p>
<ul>
<li>Largest possible height is all non-leaf nodes have 1 item.
<ul>
<li><img src="/images/CS61B/91652297.png" /></li>
</ul></li>
<li>Smallest possible height is all nodes have L items.
<ul>
<li><img src="/images/CS61B/91652298.png" /></li>
</ul></li>
<li>Overall height is therefore Θ(log N).</li>
</ul>
<h3 id="runtime-for-contains">Runtime for contains</h3>
<p>Runtime for contains:</p>
<ul>
<li>Worst case number of nodes to inspect: H + 1</li>
<li>Worst case number of items to inspect per node: L</li>
<li>Overall runtime: O(HL)</li>
</ul>
<p>Since H = Θ(log N), overall runtime is O(L log N).</p>
<ul>
<li>Since L is a constant, runtime is therefore O(log N).</li>
</ul>
<h3 id="runtime-for-add">Runtime for add</h3>
<p>Runtime for add:</p>
<ul>
<li>Worst case number of nodes to inspect: H + 1</li>
<li>Worst case number of items to inspect per node: L</li>
<li>Worst case number of split operations: H + 1</li>
<li>Overall runtime: O(HL) = O(L)</li>
</ul>
<p>Since H = Θ(log N), overall runtime is O(L log N).</p>
<p>Bottom line: contains and add are both O(log N).</p>
<h3 id="overview">Overview</h3>
<p>The worst-case runtime situation for search in a B-tree would be if each node had the maximum number of elements in it and we had to traverse all the way to the bottom. We will use L to denote the number of elements in each node. This means would would need to explore log<em>N</em> nodes (since the max height is log<em>N</em> due to the bushiness invariant) and at each node we would need to explore L elements. In total, we would need to run Llog<em>N</em> operations. However, we know L is a constant, so our total runtime is O(log<em>N</em>).</p>
<h2 id="summary">Summary</h2>
<p>BSTs have best case height Θ(log<em>N</em>), and worst case height Θ(<em>N</em>).</p>
<ul>
<li>Big O is not the same thing as worst case!</li>
</ul>
<p>B-Trees are a modification of the binary search tree that avoids Θ(<em>N</em>) worst case.</p>
<ul>
<li>Nodes may contain between 11 and L<em>L</em> items.</li>
<li>contains works almost exactly like a normal BST.</li>
<li>add works by adding items to existing leaf nodes.
<ul>
<li>If nodes are too full, they split.</li>
</ul></li>
<li>Resulting tree has perfect balance. Runtime for operations is O<em>(log</em>N*).</li>
<li>Have not discussed deletion. See extra slides if you’re curious.</li>
<li>Have not discussed how splitting works if L &gt; 3 (see some other class).</li>
<li>B-trees are more complex, but they can efficiently handle ANY insertion order.</li>
</ul>
<h2 id="overview-1">Overview</h2>
<h3 id="bsts">BSTs</h3>
<p><strong>Depth</strong> We define the depth of a <em>node</em> as how far it is from the root. For consistency, we say the root has a depth of 0.</p>
<p><strong>Height</strong> We define the height of a tree as the depth of the deepest node.</p>
<p>Notice that depending on how we insert into our BST, our height could vary drastically. We say a tree is “spindly” if it has height close to N and a tree is “bushy” if its height is closer to logN. For operations such as getting a node, we want to have the height to be as small as possible, thus favouring “bushy” BSTs</p>
<h3 id="b-trees-1">B-Trees</h3>
<p>Two specific B-Trees in this course are 2-3 Trees (A B-Tree where each node has 2 or 3 children), and 2-3-4/2-4 Trees (A B-Tree where each node has 2, 3, or 4 children). The key idea of a B-Tree is to over stuff the nodes at the bottom to prevent increasing the height of the tree. This allows us to ensure a max height of logN.</p>
<p>Make sure you know how to insert into a B-Tree. Refer back to lecture slides for examples.</p>
<p>With our restriction on height, we get that the runtime for contains and add are both Θ(log<em>N</em>).</p>
<h4 id="b-tree-invariants-2">B-Tree invariants</h4>
<p>Because of how we add to our tree, we get two nice invariants for B-Trees:</p>
<ol type="1">
<li>All leaves must be the same distance from the source</li>
<li>A non-leaf node with k items must has exactly k+1 children.</li>
</ol>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Chaoqun Yin</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://yintelligence.tech/2021/04/07/2021-04-07-B-Trees/">https://yintelligence.tech/2021/04/07/2021-04-07-B-Trees/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Chaoqun Yin</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Data-Structures/">
                                    <span class="chip bg-color">Data Structures</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Current
            </div>
            <div class="card">
                <a href="/2021/04/07/2021-04-07-B-Trees/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="B-Trees">
                        
                        <span class="card-title">B-Trees</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Analysis of Algorithms
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-04-07
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Data-model/" class="post-category">
                                    Data model
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Data-Structures/">
                        <span class="chip bg-color">Data Structures</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/04/07/2021-04-07-Advice-for-Applying-Machine-Learning/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="Advice for Applying Machine Learning 机器学习应用建议">
                        
                        <span class="card-title">Advice for Applying Machine Learning 机器学习应用建议</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            How to tell when a learning algorithm is doing poorly, and describe the 'best practices' for how to 'debug' your learning algorithm and go about improving its performance.
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-04-07
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Artificial-Intelligence/" class="post-category">
                                    Artificial Intelligence
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Machine-Learning/">
                        <span class="chip bg-color">Machine Learning</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'From: Chaoqun Yin<br />'
            + 'Author: Chaoqun Yin<br />'
            + 'Link: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">Chaoqun Yin</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2021";
                    var startMonth = "1";
                    var startDate = "28";
                    var startHour = "2";
                    var startMinute = "1";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/yintelligence" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:Yintelligence@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
